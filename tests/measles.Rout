
R version 4.2.1 (2022-06-23) -- "Funny-Looking Kid"
Copyright (C) 2022 The R Foundation for Statistical Computing
Platform: x86_64-apple-darwin17.0 (64-bit)

R is free software and comes with ABSOLUTELY NO WARRANTY.
You are welcome to redistribute it under certain conditions.
Type 'license()' or 'licence()' for distribution details.

R is a collaborative project with many contributors.
Type 'contributors()' for more information and
'citation()' on how to cite R or R packages in publications.

Type 'demo()' for some demos, 'help()' for on-line help, or
'help.start()' for an HTML browser interface to help.
Type 'q()' to quit R.

> 
> 
> library(spatPomp)
Loading required package: pomp

Attaching package: 'spatPomp'

The following object is masked from 'package:pomp':

    mcap

> set.seed(1)
> 
> ## a default measles model with fixed shared initial value parameters (IVPs)
> ## compiled into the object
> 
> m_U <- 2 
> m <- measles(U=m_U)
> 
> range(time(m))
[1] 1950 1965
> 
> m <- window(m,1950,1955)
> 
> m_params <- c(R0=56.8,amplitude=0.554,gamma=30.4,sigma=28.9,mu=0.02,sigmaSE=0.02,rho=0.488,psi=0.116,g=100,alpha=1,iota=0,cohort=0.1)
> 
> m_pf <- pfilter(m,Np=20,params=m_params)
> logLik(m_pf)
[1] -47516.83
> 
> ## setting IVPs
> 
> m2 <- measles(U=m_U,fixed_ivps=FALSE)
> m2 <- window(m2,1950,1955)
> 
> m2_shared_params <- c(R0=56.8,amplitude=0.554,gamma=30.4,sigma=28.9,mu=0.02,sigmaSE=0.02,rho=0.488,psi=0.116,g=100,alpha=1,iota=0,cohort=0.1)
> m2_unit_ivp_names <- c('S','E','I')
> m2_statenames <- paste0(rep(m2_unit_ivp_names,each=m_U),1:m_U)
> m2_ivp_names <- paste0(m2_statenames,"_0")
> m2_ivps <- rep(c(0.032,0.00005,0.00004),each=m_U)
> names(m2_ivps) <- m2_ivp_names
> m2_params <- c(m2_shared_params,m2_ivps)
> 
> set.seed(1)
> m2_pf <- pfilter(m2,Np=20,params=m2_params)
> logLik(m2_pf)
[1] -45830.66
> 
> 
> proc.time()
   user  system elapsed 
  2.555   0.741   4.449 
